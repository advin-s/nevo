import{n as c,q as u}from"./chunk-4O2ZYKII.js";import{La as l,P as a,V as s,k as i}from"./chunk-TEVMBHQZ.js";var g=class r{token=new i(null);router=s(u);constructor(){l(()=>{if(typeof localStorage<"u"){let e=localStorage.getItem("userToken"),t=parseInt(localStorage.getItem("expiresIn")?.split(",").join("")||"0");this.router.events.subscribe(o=>{o instanceof c&&localStorage.setItem("lastRoute",o.urlAfterRedirects)});let n=new Date().getTime();if(console.log(n),e&&t>n){this.token.next(e);let o=localStorage.getItem("lastRoute");o?this.router.navigateByUrl(o):this.router.navigate(["nevo"],{replaceUrl:!0})}else this.token.next(e)}})}storeToken(e){this.token.next(e);let t=new Date().getTime()+60*60*1e3;localStorage.setItem("userToken",e),localStorage.setItem("expiresIn",t.toLocaleString())}clearToken(){this.token.next(null),localStorage.removeItem("userToken"),this.router.navigate([""])}static \u0275fac=function(t){return new(t||r)};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{g as a};
